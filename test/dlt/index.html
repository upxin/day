<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>复试票统计及中奖号码标红</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; }
    h1, h2 { text-align: center; }
    table { border-collapse: collapse; margin: 20px auto; width: 80%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f4f4f4; }
    #total { text-align: center; font-weight: bold; }
    .goal { color: red; font-weight: bold; }
  </style>
  <!-- 引入外部数据文件，文件中定义了全局变量 input -->
  <script src="./2025031.js"></script>
</head>
<body>
  <h1>复试票号码出现次数统计及中奖号码标红</h1>
  <div id="front-table"></div>
  <div id="back-table"></div>
  <div id="total"></div>
  
  <script>
    // 模拟中奖号码：前区前5个号码，后区后2个号码
    const goal = [14, 18, 20, 25, 35, 1, 7];
    const goalFront = goal.slice(0, 5);
    const goalBack  = goal.slice(5);

    // 处理复试票数据（每行视为一注复式票，不展开组合）
    function countFushuTickets(input) {
      let frontCounts = Array(36).fill(0); // 前区 1-35
      let backCounts = Array(13).fill(0);  // 后区 1-12
      const lines = input.trim().split("\n");
      lines.forEach(line => {
        const parts = line.split("#").map(part => part.trim());
        // 统计前区号码
        if (parts[0]) {
          parts[0].split(/\s+/)
            .map(Number)
            .filter(n => n >= 1 && n <= 35)
            .forEach(num => frontCounts[num]++);
        }
        // 统计后区号码
        if (parts[1]) {
          parts[1].split(/\s+/)
            .map(Number)
            .filter(n => n >= 1 && n <= 12)
            .forEach(num => backCounts[num]++);
        }
      });
      return { frontCounts, backCounts, totalLines: lines.length };
    }

    // 根据统计数据生成数组，每个对象包含 "号码"、"出现次数" 和 "出现比例"
    function generateStatsArray(data, range, totalLines) {
      const result = [];
      for (let i = 1; i <= range; i++) {
        if (data[i] > 0) {
          let percentage = ((data[i] / totalLines) * 100).toFixed(1) + "%";
          result.push({
            "号码": i.toString().padStart(2, "0"),
            "出现次数": data[i],
            "出现比例": percentage
          });
        }
      }
      // 按出现次数降序排列
      return result.sort((a, b) => b["出现次数"] - a["出现次数"]);
    }

    // 生成 HTML 表格，如果号码在 winningNumbers 中则标红显示
    function createHTMLTable(dataArray, title, winningNumbers) {
      let html = `<h2>${title} 出现次数及比例（复试统计）</h2>`;
      html += `<table><thead><tr><th>号码</th><th>出现次数</th><th>出现比例</th></tr></thead><tbody>`;
      dataArray.forEach(item => {
        const num = parseInt(item["号码"]);
        const isGoal = winningNumbers.includes(num);
        html += `<tr>
          <td${isGoal ? ' class="goal"' : ''}>${item["号码"]}</td>
          <td${isGoal ? ' class="goal"' : ''}>${item["出现次数"]}</td>
          <td${isGoal ? ' class="goal"' : ''}>${item["出现比例"]}</td>
        </tr>`;
      });
      html += `</tbody></table>`;
      return html;
    }

    // 执行统计
    const { frontCounts, backCounts, totalLines } = countFushuTickets(input);
    const frontStatsArray = generateStatsArray(frontCounts, 35, totalLines);
    const backStatsArray  = generateStatsArray(backCounts, 12, totalLines);

    // 将统计结果插入到页面中，中奖号码对应的单元格标红
    document.getElementById("front-table").innerHTML = createHTMLTable(frontStatsArray, "前区", goalFront);
    document.getElementById("back-table").innerHTML  = createHTMLTable(backStatsArray, "后区", goalBack);
    document.getElementById("total").innerHTML = `<p>共统计 ${totalLines} 组复式票</p>`;
  </script>
</body>
</html>
